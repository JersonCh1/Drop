"use strict";(self.webpackChunkdropshipping_frontend=self.webpackChunkdropshipping_frontend||[]).push([[788],{1788:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var t=a(5043),r=a(6625),l=a(2339),n=a(5475),o=a(579);const d=()=>{const{user:e}=(0,r.As)(),[s,a]=(0,t.useState)(null),[d,i]=(0,t.useState)([]),[c,x]=(0,t.useState)(!0),[m,p]=(0,t.useState)(""),[h,u]=(0,t.useState)(!1);(0,t.useEffect)(()=>{e?(g(),b()):x(!1)},[e]);const g=async()=>{try{const e=localStorage.getItem("authToken"),s=await fetch("".concat("https://drop-production-cd2b.up.railway.app/api","/api/loyalty/me"),{headers:{Authorization:"Bearer ".concat(e)}}),t=await s.json();a(t)}catch(e){console.error("Error loading loyalty data:",e),l.Ay.error("Error al cargar puntos")}finally{x(!1)}},b=async()=>{try{const e=await fetch("".concat("https://drop-production-cd2b.up.railway.app/api","/api/loyalty/leaderboard")),s=await e.json();i(s.leaderboard||[])}catch(e){console.error("Error loading leaderboard:",e)}};return e?c?(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,o.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Programa de Lealtad"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Gana puntos con cada compra y canj\xe9alos por descuentos"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,o.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl shadow-md p-8 text-white",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-blue-100 text-sm font-medium mb-1",children:"Puntos Disponibles"}),(0,o.jsx)("p",{className:"text-5xl font-bold",children:(null===s||void 0===s?void 0:s.points)||0})]}),(0,o.jsx)("div",{className:"bg-white bg-opacity-20 rounded-full p-4",children:(0,o.jsx)("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,o.jsxs)("div",{className:"bg-white bg-opacity-10 rounded-lg p-3",children:[(0,o.jsx)("p",{className:"text-2xl font-bold",children:(null===s||void 0===s?void 0:s.totalEarned)||0}),(0,o.jsx)("p",{className:"text-xs text-blue-100",children:"Total Ganado"})]}),(0,o.jsxs)("div",{className:"bg-white bg-opacity-10 rounded-lg p-3",children:[(0,o.jsx)("p",{className:"text-2xl font-bold",children:(null===s||void 0===s?void 0:s.totalSpent)||0}),(0,o.jsx)("p",{className:"text-xs text-blue-100",children:"Total Canjeado"})]}),(0,o.jsxs)("div",{className:"bg-white bg-opacity-10 rounded-lg p-3",children:[(0,o.jsxs)("p",{className:"text-2xl font-bold",children:["$",(null===s||void 0===s?void 0:s.valueInDollars)||"0.00"]}),(0,o.jsx)("p",{className:"text-xs text-blue-100",children:"Valor en $"})]})]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Canjear Puntos"}),(0,o.jsxs)("p",{className:"text-gray-600 mb-4",children:[null===s||void 0===s?void 0:s.config.REDEMPTION_RATE," puntos = $1.00 de descuento"]}),(0,o.jsxs)("div",{className:"flex gap-3",children:[(0,o.jsx)("input",{type:"number",min:"0",max:(null===s||void 0===s?void 0:s.points)||0,step:"100",value:m,onChange:e=>p(e.target.value),placeholder:"Cantidad de puntos",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,o.jsx)("button",{onClick:async()=>{const e=parseInt(m);if(!e||e<=0)l.Ay.error("Ingresa una cantidad v\xe1lida");else if(!s||e>s.points)l.Ay.error("No tienes suficientes puntos");else{u(!0);try{const s=localStorage.getItem("authToken"),a=await fetch("".concat("https://drop-production-cd2b.up.railway.app/api","/api/loyalty/redeem"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({points:e})}),t=await a.json();a.ok?(l.Ay.success(t.message),p(""),g()):l.Ay.error(t.error||"Error al canjear puntos")}catch(a){console.error("Error redeeming points:",a),l.Ay.error("Error al canjear puntos")}finally{u(!1)}}},disabled:h||!m,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-medium",children:h?"Canjeando...":"Canjear"})]}),m&&parseInt(m)>0&&(0,o.jsxs)("p",{className:"mt-3 text-sm text-gray-600",children:["Recibir\xe1s: ",(0,o.jsxs)("span",{className:"font-semibold text-green-600",children:["$",(parseInt(m)/((null===s||void 0===s?void 0:s.config.REDEMPTION_RATE)||100)).toFixed(2)]})," de descuento"]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"\xbfC\xf3mo ganar puntos?"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-blue-50 rounded-lg",children:[(0,o.jsx)("div",{className:"bg-blue-600 text-white rounded-full p-2",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-semibold text-gray-900",children:"Realizar Compras"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Gana ",null===s||void 0===s?void 0:s.config.PER_DOLLAR," puntos por cada d\xf3lar gastado"]})]})]}),(0,o.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-green-50 rounded-lg",children:[(0,o.jsx)("div",{className:"bg-green-600 text-white rounded-full p-2",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-semibold text-gray-900",children:"Dejar Rese\xf1as"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Gana ",null===s||void 0===s?void 0:s.config.PER_REVIEW," puntos por cada rese\xf1a que dejes"]})]})]}),(0,o.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-purple-50 rounded-lg",children:[(0,o.jsx)("div",{className:"bg-purple-600 text-white rounded-full p-2",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-semibold text-gray-900",children:"Referir Amigos"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Gana ",null===s||void 0===s?void 0:s.config.PER_REFERRAL," puntos cuando un amigo haga su primera compra"]})]})]})]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Historial de Transacciones"}),null!==s&&void 0!==s&&s.transactions&&s.transactions.length>0?(0,o.jsx)("div",{className:"space-y-3",children:s.transactions.map(e=>(0,o.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-medium text-gray-900",children:e.description}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.createdAt).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"})})]}),(0,o.jsxs)("div",{className:"text-lg font-bold ".concat(e.points>0?"text-green-600":"text-red-600"),children:[e.points>0?"+":"",e.points]})]},e.id))}):(0,o.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No tienes transacciones a\xfan. \xa1Comienza a ganar puntos!"})]})]}),(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,o.jsx)("span",{children:"\ud83c\udfc6"}),"Top 10 Miembros"]}),d.length>0?(0,o.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,o.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg ".concat(e.rank<=3?"bg-gradient-to-r from-yellow-50 to-orange-50":"bg-gray-50"),children:[(0,o.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold ".concat(1===e.rank?"bg-yellow-400 text-yellow-900":2===e.rank?"bg-gray-300 text-gray-700":3===e.rank?"bg-orange-400 text-orange-900":"bg-gray-200 text-gray-600"),children:e.rank}),(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,o.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.name}),(0,o.jsxs)("p",{className:"text-xs text-gray-600",children:[e.totalEarned," puntos totales"]})]}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsx)("p",{className:"font-semibold text-blue-600",children:e.currentPoints}),(0,o.jsx)("p",{className:"text-xs text-gray-500",children:"actuales"})]})]},e.rank))}):(0,o.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No hay datos disponibles"})]}),(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Acciones R\xe1pidas"}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)(n.N_,{to:"/products",className:"block w-full bg-blue-600 text-white text-center py-3 rounded-lg hover:bg-blue-700 font-medium transition-colors",children:"Comprar Productos"}),(0,o.jsx)(n.N_,{to:"/orders",className:"block w-full bg-gray-100 text-gray-700 text-center py-3 rounded-lg hover:bg-gray-200 font-medium transition-colors",children:"Ver Mis Pedidos"})]})]})]})]})]})}):(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-md text-center max-w-md",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udd12"}),(0,o.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Inicia sesi\xf3n para ver tus puntos"}),(0,o.jsx)("p",{className:"text-gray-600 mb-6",children:"Accede a tu cuenta para ganar y canjear puntos de lealtad"}),(0,o.jsx)(n.N_,{to:"/login",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium",children:"Iniciar Sesi\xf3n"})]})})}}}]);
//# sourceMappingURL=788.fccc28a8.chunk.js.map