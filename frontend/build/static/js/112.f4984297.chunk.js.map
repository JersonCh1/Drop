{"version":3,"file":"static/js/112.f4984297.chunk.js","mappings":"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","sources":["components/compare/CompareButton.tsx","components/products/ProductReviews.tsx","components/products/UpsellCrossSell.tsx","pages/ProductDetailPage.tsx","services/wishlistService.ts","components/wishlist/WishlistButton.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useCompare } from '../../context/CompareContext';\r\nimport { Product } from '../../services/productService';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface CompareButtonProps {\r\n  product: Product;\r\n  variant?: 'icon' | 'button';\r\n  size?: 'sm' | 'md' | 'lg';\r\n  className?: string;\r\n}\r\n\r\nconst CompareButton: React.FC<CompareButtonProps> = ({\r\n  product,\r\n  variant = 'icon',\r\n  size = 'md',\r\n  className = ''\r\n}) => {\r\n  const { addToCompare, removeFromCompare, isInCompare, compareProducts } = useCompare();\r\n  const inCompare = isInCompare(product.id);\r\n\r\n  const handleToggleCompare = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (inCompare) {\r\n      removeFromCompare(product.id);\r\n      toast.success('Eliminado del comparador');\r\n    } else {\r\n      if (compareProducts.length >= 4) {\r\n        toast.error('Máximo 4 productos para comparar');\r\n        return;\r\n      }\r\n      addToCompare(product);\r\n      toast.success('Añadido al comparador');\r\n    }\r\n  };\r\n\r\n  const sizeClasses = {\r\n    sm: 'w-8 h-8',\r\n    md: 'w-10 h-10',\r\n    lg: 'w-12 h-12'\r\n  };\r\n\r\n  const iconSizes = {\r\n    sm: 'w-4 h-4',\r\n    md: 'w-5 h-5',\r\n    lg: 'w-6 h-6'\r\n  };\r\n\r\n  if (variant === 'icon') {\r\n    return (\r\n      <button\r\n        onClick={handleToggleCompare}\r\n        className={`${sizeClasses[size]} flex items-center justify-center rounded-full transition-all duration-300 ${\r\n          inCompare\r\n            ? 'bg-blue-500 text-white hover:bg-blue-600'\r\n            : 'bg-white text-gray-600 hover:bg-blue-50 hover:text-blue-500'\r\n        } hover:scale-110 shadow-md ${className}`}\r\n        aria-label={inCompare ? 'Eliminar del comparador' : 'Añadir al comparador'}\r\n      >\r\n        <svg className={iconSizes[size]} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"\r\n          />\r\n        </svg>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <button\r\n      onClick={handleToggleCompare}\r\n      className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-300 ${\r\n        inCompare\r\n          ? 'bg-blue-500 text-white hover:bg-blue-600'\r\n          : 'bg-gray-100 text-gray-700 hover:bg-blue-50 hover:text-blue-500'\r\n      } ${className}`}\r\n    >\r\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          strokeWidth={2}\r\n          d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"\r\n        />\r\n      </svg>\r\n      <span>{inCompare ? 'En comparador' : 'Comparar'}</span>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default CompareButton;\r\n","// frontend/src/components/products/ProductReviews.tsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface Review {\r\n  id: string;\r\n  rating: number;\r\n  title: string;\r\n  comment: string;\r\n  customerName: string;\r\n  isVerified: boolean;\r\n  createdAt: string;\r\n}\r\n\r\ninterface ReviewStats {\r\n  averageRating: number;\r\n  totalReviews: number;\r\n  distribution: {\r\n    1: number;\r\n    2: number;\r\n    3: number;\r\n    4: number;\r\n    5: number;\r\n  };\r\n}\r\n\r\ninterface ProductReviewsProps {\r\n  productId: string;\r\n}\r\n\r\nconst ProductReviews: React.FC<ProductReviewsProps> = ({ productId }) => {\r\n  const { user } = useAuth();\r\n  const [reviews, setReviews] = useState<Review[]>([]);\r\n  const [stats, setStats] = useState<ReviewStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showForm, setShowForm] = useState(false);\r\n\r\n  // Form state\r\n  const [rating, setRating] = useState(5);\r\n  const [title, setTitle] = useState('');\r\n  const [comment, setComment] = useState('');\r\n  const [customerName, setCustomerName] = useState('');\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';\r\n\r\n  useEffect(() => {\r\n    loadReviews();\r\n  }, [productId]);\r\n\r\n  const loadReviews = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch(`${API_URL}/reviews/product/${productId}`);\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setReviews(data.data.reviews);\r\n        setStats(data.data.stats);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading reviews:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmitReview = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!user && !customerName.trim()) {\r\n      toast.error('Por favor ingresa tu nombre');\r\n      return;\r\n    }\r\n\r\n    if (!comment.trim()) {\r\n      toast.error('Por favor escribe un comentario');\r\n      return;\r\n    }\r\n\r\n    setSubmitting(true);\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reviews`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          productId,\r\n          rating,\r\n          title: title.trim() || null,\r\n          comment: comment.trim(),\r\n          customerName: !user ? customerName.trim() : null,\r\n          userId: user?.id || null,\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        toast.success('¡Gracias por tu review! Será publicada después de moderación.');\r\n        setShowForm(false);\r\n        setRating(5);\r\n        setTitle('');\r\n        setComment('');\r\n        setCustomerName('');\r\n      } else {\r\n        toast.error(data.message || 'Error al enviar review');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error submitting review:', error);\r\n      toast.error('Error al enviar review');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const renderStars = (rating: number, size: 'sm' | 'md' | 'lg' = 'md') => {\r\n    const sizeClasses = {\r\n      sm: 'w-3 h-3',\r\n      md: 'w-4 h-4',\r\n      lg: 'w-5 h-5',\r\n    };\r\n\r\n    return (\r\n      <div className=\"flex\">\r\n        {[1, 2, 3, 4, 5].map((star) => (\r\n          <svg\r\n            key={star}\r\n            className={`${sizeClasses[size]} ${\r\n              star <= rating ? 'text-yellow-400' : 'text-gray-300'\r\n            } fill-current`}\r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path d=\"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z\" />\r\n          </svg>\r\n        ))}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderRatingDistribution = () => {\r\n    if (!stats) return null;\r\n\r\n    return (\r\n      <div className=\"space-y-2\">\r\n        {[5, 4, 3, 2, 1].map((star) => {\r\n          const count = stats.distribution[star as keyof typeof stats.distribution] || 0;\r\n          const percentage =\r\n            stats.totalReviews > 0 ? (count / stats.totalReviews) * 100 : 0;\r\n\r\n          return (\r\n            <div key={star} className=\"flex items-center space-x-3\">\r\n              <div className=\"flex items-center space-x-1 w-16\">\r\n                <span className=\"text-sm font-medium\">{star}</span>\r\n                <svg className=\"w-3 h-3 text-yellow-400 fill-current\" viewBox=\"0 0 20 20\">\r\n                  <path d=\"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z\" />\r\n                </svg>\r\n              </div>\r\n              <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\r\n                <div\r\n                  className=\"bg-yellow-400 h-2 rounded-full transition-all duration-300\"\r\n                  style={{ width: `${percentage}%` }}\r\n                ></div>\r\n              </div>\r\n              <span className=\"text-sm text-gray-600 w-12 text-right\">{count}</span>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"py-8\">\r\n        <div className=\"animate-pulse space-y-4\">\r\n          <div className=\"h-8 bg-gray-200 rounded w-1/3\"></div>\r\n          <div className=\"h-20 bg-gray-200 rounded\"></div>\r\n          <div className=\"h-20 bg-gray-200 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"py-8\">\r\n      {/* Header with Stats */}\r\n      <div className=\"mb-8\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">\r\n          Opiniones de Clientes\r\n        </h2>\r\n\r\n        {stats && stats.totalReviews > 0 ? (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 bg-gray-50 rounded-2xl p-6 border border-gray-200\">\r\n            {/* Overall Rating */}\r\n            <div className=\"text-center md:text-left\">\r\n              <div className=\"flex items-center justify-center md:justify-start space-x-4 mb-4\">\r\n                <div className=\"text-5xl font-black text-gray-900\">\r\n                  {stats.averageRating.toFixed(1)}\r\n                </div>\r\n                <div>\r\n                  {renderStars(Math.round(stats.averageRating), 'lg')}\r\n                  <p className=\"text-sm text-gray-600 mt-1\">\r\n                    Basado en {stats.totalReviews} opiniones\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Rating Distribution */}\r\n            <div>{renderRatingDistribution()}</div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"bg-gray-50 rounded-2xl p-8 text-center border border-gray-200\">\r\n            <p className=\"text-gray-600\">\r\n              Sé el primero en dejar una opinión sobre este producto\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Write Review Button */}\r\n      {!showForm && (\r\n        <div className=\"mb-8\">\r\n          <button\r\n            onClick={() => setShowForm(true)}\r\n            className=\"w-full md:w-auto px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl\"\r\n          >\r\n            ✍️ Escribir una opinión\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Review Form */}\r\n      {showForm && (\r\n        <div className=\"mb-8 bg-white rounded-2xl border-2 border-blue-200 p-6 shadow-lg\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-xl font-bold text-gray-900\">Tu opinión</h3>\r\n            <button\r\n              onClick={() => setShowForm(false)}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <form onSubmit={handleSubmitReview} className=\"space-y-4\">\r\n            {/* Rating */}\r\n            <div>\r\n              <label className=\"block text-sm font-bold text-gray-700 mb-2\">\r\n                Calificación\r\n              </label>\r\n              <div className=\"flex space-x-2\">\r\n                {[1, 2, 3, 4, 5].map((star) => (\r\n                  <button\r\n                    key={star}\r\n                    type=\"button\"\r\n                    onClick={() => setRating(star)}\r\n                    className=\"focus:outline-none transition-transform hover:scale-110\"\r\n                  >\r\n                    <svg\r\n                      className={`w-8 h-8 ${\r\n                        star <= rating ? 'text-yellow-400' : 'text-gray-300'\r\n                      } fill-current`}\r\n                      viewBox=\"0 0 20 20\"\r\n                    >\r\n                      <path d=\"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z\" />\r\n                    </svg>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Name (if not logged in) */}\r\n            {!user && (\r\n              <div>\r\n                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\r\n                  Tu nombre *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={customerName}\r\n                  onChange={(e) => setCustomerName(e.target.value)}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  placeholder=\"Ej: Juan P.\"\r\n                  required\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Title */}\r\n            <div>\r\n              <label className=\"block text-sm font-bold text-gray-700 mb-2\">\r\n                Título (opcional)\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={title}\r\n                onChange={(e) => setTitle(e.target.value)}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                placeholder=\"Ej: Excelente calidad\"\r\n                maxLength={100}\r\n              />\r\n            </div>\r\n\r\n            {/* Comment */}\r\n            <div>\r\n              <label className=\"block text-sm font-bold text-gray-700 mb-2\">\r\n                Tu opinión *\r\n              </label>\r\n              <textarea\r\n                value={comment}\r\n                onChange={(e) => setComment(e.target.value)}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n                rows={4}\r\n                placeholder=\"Cuéntanos qué te pareció el producto...\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            {/* Submit */}\r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={submitting}\r\n                className=\"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {submitting ? 'Enviando...' : 'Publicar opinión'}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowForm(false)}\r\n                className=\"px-6 py-3 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition-colors\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n            </div>\r\n\r\n            <p className=\"text-xs text-gray-500\">\r\n              * Tu opinión será revisada antes de publicarse\r\n            </p>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reviews List */}\r\n      {reviews.length > 0 ? (\r\n        <div className=\"space-y-4\">\r\n          {reviews.map((review) => (\r\n            <div\r\n              key={review.id}\r\n              className=\"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow duration-300\"\r\n            >\r\n              {/* Header */}\r\n              <div className=\"flex items-start justify-between mb-3\">\r\n                <div>\r\n                  <div className=\"flex items-center space-x-2 mb-1\">\r\n                    {renderStars(review.rating, 'sm')}\r\n                    {review.isVerified && (\r\n                      <span className=\"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-semibold\">\r\n                        ✓ Compra verificada\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <p className=\"font-bold text-gray-900\">{review.customerName}</p>\r\n                </div>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  {new Date(review.createdAt).toLocaleDateString('es-ES', {\r\n                    year: 'numeric',\r\n                    month: 'long',\r\n                    day: 'numeric',\r\n                  })}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Title */}\r\n              {review.title && (\r\n                <h4 className=\"font-bold text-gray-900 mb-2\">{review.title}</h4>\r\n              )}\r\n\r\n              {/* Comment */}\r\n              <p className=\"text-gray-700 leading-relaxed\">{review.comment}</p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        !showForm && (\r\n          <div className=\"text-center py-8\">\r\n            <p className=\"text-gray-500\">\r\n              No hay opiniones todavía. ¡Sé el primero en dejar una!\r\n            </p>\r\n          </div>\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductReviews;\r\n","// frontend/src/components/products/UpsellCrossSell.tsx\r\nimport React, { useState } from 'react';\r\nimport { useCart } from '../../context/CartContext';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface UpsellProduct {\r\n  id: number;\r\n  name: string;\r\n  price: number;\r\n  originalPrice: number;\r\n  image: string;\r\n  rating: number;\r\n  reviews: number;\r\n  inStock: boolean;\r\n}\r\n\r\ninterface BundleOffer {\r\n  id: number;\r\n  title: string;\r\n  products: string[];\r\n  discount: number;\r\n  price: number;\r\n  originalPrice: number;\r\n  savings: number;\r\n  badge?: string;\r\n}\r\n\r\nconst UpsellCrossSell: React.FC = () => {\r\n  const { addItem } = useCart();\r\n  const [selectedBundle, setSelectedBundle] = useState<number | null>(null);\r\n\r\n  // Mock data - En producción vendría de una API\r\n  const relatedProducts: UpsellProduct[] = [\r\n    {\r\n      id: 2,\r\n      name: 'Protector de Pantalla Premium',\r\n      price: 12.99,\r\n      originalPrice: 19.99,\r\n      image: 'https://images.unsplash.com/photo-1601784551446-20c9e07cdbdb?w=400',\r\n      rating: 4.9,\r\n      reviews: 892,\r\n      inStock: true\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Cable USB-C Reforzado',\r\n      price: 15.99,\r\n      originalPrice: 24.99,\r\n      image: 'https://images.unsplash.com/photo-1583863788434-e58a36330cf0?w=400',\r\n      rating: 4.7,\r\n      reviews: 456,\r\n      inStock: true\r\n    },\r\n    {\r\n      id: 4,\r\n      name: 'Soporte Magnético para Auto',\r\n      price: 18.99,\r\n      originalPrice: 29.99,\r\n      image: 'https://images.unsplash.com/photo-1519558260268-cde7e03a0152?w=400',\r\n      rating: 4.8,\r\n      reviews: 234,\r\n      inStock: true\r\n    },\r\n    {\r\n      id: 5,\r\n      name: 'Auriculares Bluetooth',\r\n      price: 34.99,\r\n      originalPrice: 59.99,\r\n      image: 'https://images.unsplash.com/photo-1590658165737-15a047b7a9de?w=400',\r\n      rating: 4.6,\r\n      reviews: 678,\r\n      inStock: false\r\n    }\r\n  ];\r\n\r\n  const bundles: BundleOffer[] = [\r\n    {\r\n      id: 1,\r\n      title: 'Pack Protección Completa',\r\n      products: ['Carcasa Premium', 'Protector de Pantalla', 'Cable USB-C'],\r\n      discount: 25,\r\n      price: 49.99,\r\n      originalPrice: 66.97,\r\n      savings: 16.98,\r\n      badge: 'MÁS VENDIDO'\r\n    },\r\n    {\r\n      id: 2,\r\n      title: 'Pack Auto + Carga',\r\n      products: ['Carcasa Premium', 'Soporte para Auto', 'Cable USB-C'],\r\n      discount: 20,\r\n      price: 54.99,\r\n      originalPrice: 68.97,\r\n      savings: 13.98,\r\n      badge: 'OFERTA'\r\n    },\r\n    {\r\n      id: 3,\r\n      title: 'Pack Todo Incluido',\r\n      products: ['Carcasa', 'Protector', 'Cable', 'Soporte Auto', 'Auriculares'],\r\n      discount: 30,\r\n      price: 89.99,\r\n      originalPrice: 128.95,\r\n      savings: 38.96,\r\n      badge: 'MEJOR VALOR'\r\n    }\r\n  ];\r\n\r\n  const handleAddToCart = (product: UpsellProduct) => {\r\n    const item = {\r\n      id: `upsell-${product.id}`,\r\n      productId: product.id,\r\n      variantId: product.id,\r\n      name: product.name,\r\n      price: product.price,\r\n      quantity: 1,\r\n      image: product.image,\r\n      model: 'Universal',\r\n      color: 'N/A'\r\n    };\r\n\r\n    addItem(item);\r\n    toast.success(`${product.name} agregado al carrito!`, { icon: '✅' });\r\n  };\r\n\r\n  const handleAddBundle = (bundle: BundleOffer) => {\r\n    setSelectedBundle(bundle.id);\r\n    toast.success(`${bundle.title} agregado al carrito!`, { icon: '🎁' });\r\n    setTimeout(() => setSelectedBundle(null), 2000);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-8 mt-8\">\r\n      {/* Bundles Section */}\r\n      <div>\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div>\r\n            <h3 className=\"text-2xl font-black bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n              🎁 Combos Especiales\r\n            </h3>\r\n            <p className=\"text-gray-600 text-sm mt-1\">Ahorra más comprando en paquete</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          {bundles.map((bundle) => (\r\n            <div\r\n              key={bundle.id}\r\n              className=\"relative group bg-white rounded-2xl border-2 border-gray-200 p-6 hover:border-purple-400 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1\"\r\n            >\r\n              {/* Badge */}\r\n              {bundle.badge && (\r\n                <div className=\"absolute -top-3 -right-3 bg-gradient-to-r from-red-500 to-pink-500 text-white px-4 py-1 rounded-full text-xs font-black shadow-lg transform rotate-12\">\r\n                  {bundle.badge}\r\n                </div>\r\n              )}\r\n\r\n              {/* Discount Badge */}\r\n              <div className=\"absolute top-4 left-4 bg-green-500 text-white px-3 py-1 rounded-lg text-sm font-bold\">\r\n                -{bundle.discount}%\r\n              </div>\r\n\r\n              <div className=\"mt-8\">\r\n                <h4 className=\"text-lg font-black text-gray-900 mb-3\">{bundle.title}</h4>\r\n\r\n                {/* Products included */}\r\n                <ul className=\"space-y-2 mb-4\">\r\n                  {bundle.products.map((product, idx) => (\r\n                    <li key={idx} className=\"flex items-center text-sm text-gray-700\">\r\n                      <svg className=\"w-5 h-5 text-green-500 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                      </svg>\r\n                      {product}\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n\r\n                {/* Pricing */}\r\n                <div className=\"mb-4\">\r\n                  <div className=\"flex items-baseline space-x-2 mb-1\">\r\n                    <span className=\"text-3xl font-black text-purple-600\">${bundle.price}</span>\r\n                    <span className=\"text-lg text-gray-400 line-through\">${bundle.originalPrice}</span>\r\n                  </div>\r\n                  <p className=\"text-sm font-semibold text-green-600\">\r\n                    💰 Ahorras ${bundle.savings.toFixed(2)}\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Add to cart button */}\r\n                <button\r\n                  onClick={() => handleAddBundle(bundle)}\r\n                  disabled={selectedBundle === bundle.id}\r\n                  className={`w-full py-3 rounded-xl font-bold text-sm transition-all duration-300 ${\r\n                    selectedBundle === bundle.id\r\n                      ? 'bg-green-500 text-white'\r\n                      : 'bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700'\r\n                  }`}\r\n                >\r\n                  {selectedBundle === bundle.id ? (\r\n                    <span className=\"flex items-center justify-center\">\r\n                      <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                      </svg>\r\n                      ¡Agregado!\r\n                    </span>\r\n                  ) : (\r\n                    '🎁 Agregar Combo'\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Related Products Section */}\r\n      <div>\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div>\r\n            <h3 className=\"text-2xl font-black bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent\">\r\n              🛍️ Completa tu compra\r\n            </h3>\r\n            <p className=\"text-gray-600 text-sm mt-1\">Los clientes también compraron</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n          {relatedProducts.map((product) => (\r\n            <div\r\n              key={product.id}\r\n              className=\"group bg-white rounded-2xl border-2 border-gray-200 overflow-hidden hover:border-blue-400 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1\"\r\n            >\r\n              {/* Product Image */}\r\n              <div className=\"relative aspect-square overflow-hidden bg-gray-100\">\r\n                <img\r\n                  src={product.image}\r\n                  alt={product.name}\r\n                  className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"\r\n                />\r\n                {!product.inStock && (\r\n                  <div className=\"absolute inset-0 bg-black/60 flex items-center justify-center\">\r\n                    <span className=\"bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm\">\r\n                      Agotado\r\n                    </span>\r\n                  </div>\r\n                )}\r\n                <div className=\"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-lg text-xs font-bold\">\r\n                  -{Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100)}%\r\n                </div>\r\n              </div>\r\n\r\n              {/* Product Info */}\r\n              <div className=\"p-4\">\r\n                <h4 className=\"font-bold text-gray-900 text-sm mb-2 line-clamp-2\">{product.name}</h4>\r\n\r\n                {/* Rating */}\r\n                <div className=\"flex items-center space-x-1 mb-2\">\r\n                  <div className=\"flex text-yellow-400\">\r\n                    {[...Array(5)].map((_, i) => (\r\n                      <svg key={i} className=\"w-3 h-3 fill-current\" viewBox=\"0 0 20 20\">\r\n                        <path d=\"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z\"/>\r\n                      </svg>\r\n                    ))}\r\n                  </div>\r\n                  <span className=\"text-xs text-gray-600\">({product.reviews})</span>\r\n                </div>\r\n\r\n                {/* Price */}\r\n                <div className=\"flex items-baseline space-x-2 mb-3\">\r\n                  <span className=\"text-xl font-black text-blue-600\">${product.price}</span>\r\n                  <span className=\"text-sm text-gray-400 line-through\">${product.originalPrice}</span>\r\n                </div>\r\n\r\n                {/* Add button */}\r\n                <button\r\n                  onClick={() => handleAddToCart(product)}\r\n                  disabled={!product.inStock}\r\n                  className={`w-full py-2 rounded-lg font-bold text-xs transition-all duration-300 ${\r\n                    !product.inStock\r\n                      ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                      : 'bg-gradient-to-r from-blue-600 to-cyan-600 text-white hover:from-blue-700 hover:to-cyan-700'\r\n                  }`}\r\n                >\r\n                  {product.inStock ? '+ Agregar' : 'Agotado'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Frequently Bought Together */}\r\n      <div className=\"bg-gradient-to-br from-orange-50 to-red-50 rounded-2xl border-2 border-orange-200 p-6\">\r\n        <h3 className=\"text-xl font-black text-gray-900 mb-4 flex items-center\">\r\n          <span className=\"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center mr-3\">\r\n            <svg className=\"w-6 h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z\" />\r\n            </svg>\r\n          </span>\r\n          Comprados frecuentemente juntos\r\n        </h3>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-4\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-20 h-20 bg-white rounded-lg border-2 border-gray-200 flex items-center justify-center\">\r\n              <span className=\"text-2xl\">📱</span>\r\n            </div>\r\n            <span className=\"text-2xl text-gray-400\">+</span>\r\n            <div className=\"w-20 h-20 bg-white rounded-lg border-2 border-gray-200 flex items-center justify-center\">\r\n              <span className=\"text-2xl\">🛡️</span>\r\n            </div>\r\n            <span className=\"text-2xl text-gray-400\">+</span>\r\n            <div className=\"w-20 h-20 bg-white rounded-lg border-2 border-gray-200 flex items-center justify-center\">\r\n              <span className=\"text-2xl\">🔌</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 min-w-[200px]\">\r\n            <div className=\"flex items-baseline space-x-2 mb-2\">\r\n              <span className=\"text-2xl font-black text-orange-600\">$59.97</span>\r\n              <span className=\"text-lg text-gray-400 line-through\">$79.97</span>\r\n              <span className=\"bg-green-500 text-white px-2 py-1 rounded text-xs font-bold\">\r\n                Ahorra $20\r\n              </span>\r\n            </div>\r\n            <button className=\"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 rounded-xl font-bold text-sm hover:from-orange-600 hover:to-red-600 transition-all duration-300 shadow-lg hover:shadow-xl\">\r\n              🎯 Agregar los 3 al carrito\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UpsellCrossSell;\r\n","// frontend/src/pages/ProductDetailPage.tsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport productService, { Product, ProductVariant } from '../services/productService';\r\nimport { useCart } from '../context/CartContext';\r\nimport toast from 'react-hot-toast';\r\nimport { trackingPixels } from '../utils/trackingPixels';\r\nimport ProductReviews from '../components/products/ProductReviews';\r\nimport UpsellCrossSell from '../components/products/UpsellCrossSell';\r\nimport WishlistButton from '../components/wishlist/WishlistButton';\r\nimport CompareButton from '../components/compare/CompareButton';\r\n\r\nconst ProductDetailPage: React.FC = () => {\r\n  const { slug } = useParams<{ slug: string }>();\r\n  const navigate = useNavigate();\r\n  const { addItem } = useCart();\r\n\r\n  const [product, setProduct] = useState<Product | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedImageIndex, setSelectedImageIndex] = useState(0);\r\n  const [selectedVariant, setSelectedVariant] = useState<ProductVariant | null>(null);\r\n  const [quantity, setQuantity] = useState(1);\r\n\r\n  const loadProduct = useCallback(async () => {\r\n    if (!slug) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const data = await productService.getProductBySlug(slug);\r\n      if (data) {\r\n        setProduct(data);\r\n        // Seleccionar primera variante disponible\r\n        const availableVariants = productService.getAvailableVariants(data);\r\n        if (availableVariants.length > 0) {\r\n          setSelectedVariant(availableVariants[0]);\r\n        }\r\n\r\n        // Track ViewContent\r\n        const price = productService.getLowestPrice(data);\r\n        trackingPixels.trackViewContent({\r\n          content_name: data.name,\r\n          content_ids: [data.id],\r\n          content_type: 'product',\r\n          value: price,\r\n          currency: 'USD'\r\n        });\r\n      } else {\r\n        toast.error('Producto no encontrado');\r\n        navigate('/products');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading product:', error);\r\n      toast.error('Error al cargar el producto');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [slug, navigate]);\r\n\r\n  useEffect(() => {\r\n    loadProduct();\r\n  }, [loadProduct]);\r\n\r\n  // Refetch when tab becomes visible (e.g., after updating prices in admin)\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === 'visible') {\r\n        loadProduct();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n    };\r\n  }, [loadProduct]);\r\n\r\n  const handleAddToCart = () => {\r\n    if (!product) return;\r\n\r\n    const price = selectedVariant\r\n      ? parseFloat(selectedVariant.price)\r\n      : productService.getLowestPrice(product);\r\n\r\n    const mainImage = productService.getMainImage(product);\r\n\r\n    const item = {\r\n      id: selectedVariant ? selectedVariant.id : product.id,\r\n      productId: parseInt(product.id.replace(/[^0-9]/g, '')) || 1,\r\n      variantId: selectedVariant ? parseInt(selectedVariant.id.replace(/[^0-9]/g, '')) : undefined,\r\n      name: product.name,\r\n      price,\r\n      model: product.model || selectedVariant?.name || 'Universal',\r\n      color: selectedVariant?.color || 'Default',\r\n      quantity,\r\n      image: mainImage,\r\n      sku: selectedVariant?.sku || product.slug,\r\n      maxQuantity: selectedVariant?.stockQuantity || product.stockCount\r\n    };\r\n\r\n    addItem(item);\r\n\r\n    // Track AddToCart\r\n    trackingPixels.trackAddToCart({\r\n      content_name: item.name,\r\n      content_ids: [product.id],\r\n      content_type: 'product',\r\n      value: price * quantity,\r\n      currency: 'USD',\r\n      quantity\r\n    });\r\n  };\r\n\r\n  const currentPrice = selectedVariant\r\n    ? parseFloat(selectedVariant.price)\r\n    : (product ? productService.getLowestPrice(product) : 0);\r\n\r\n  const currentStock = selectedVariant\r\n    ? selectedVariant.stockQuantity\r\n    : product?.stockCount || 0;\r\n\r\n  const isAvailable = product && productService.isAvailable(product);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Cargando producto...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!product) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n\r\n        {/* Breadcrumb */}\r\n        <nav className=\"mb-6 text-sm\">\r\n          <ol className=\"flex items-center space-x-2 text-gray-600\">\r\n            <li><Link to=\"/\" className=\"hover:text-blue-600\">Inicio</Link></li>\r\n            <li>/</li>\r\n            <li><Link to=\"/products\" className=\"hover:text-blue-600\">Productos</Link></li>\r\n            <li>/</li>\r\n            <li className=\"text-gray-900 font-medium\">{product.name}</li>\r\n          </ol>\r\n        </nav>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12\">\r\n\r\n          {/* Image Gallery */}\r\n          <div>\r\n            <div className=\"bg-white rounded-lg shadow-md p-4 mb-4\">\r\n              <div className=\"aspect-square bg-gray-100 rounded-lg overflow-hidden\">\r\n                <img\r\n                  src={product.images[selectedImageIndex]?.url || 'https://placehold.co/600x600?text=No+Image'}\r\n                  alt={product.images[selectedImageIndex]?.altText || product.name}\r\n                  className=\"w-full h-full object-cover\"\r\n                  onError={(e) => {\r\n                    (e.target as HTMLImageElement).src = 'https://placehold.co/600x600?text=No+Image';\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Thumbnail Gallery */}\r\n            {product.images.length > 1 && (\r\n              <div className=\"grid grid-cols-4 gap-2\">\r\n                {product.images.map((image, index) => (\r\n                  <button\r\n                    key={image.id}\r\n                    onClick={() => setSelectedImageIndex(index)}\r\n                    className={`aspect-square bg-white rounded-lg overflow-hidden border-2 transition-all ${\r\n                      selectedImageIndex === index\r\n                        ? 'border-blue-600 ring-2 ring-blue-200'\r\n                        : 'border-gray-200 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <img\r\n                      src={image.url}\r\n                      alt={image.altText || `${product.name} ${index + 1}`}\r\n                      className=\"w-full h-full object-cover\"\r\n                    />\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Product Info */}\r\n          <div>\r\n            <div className=\"bg-white rounded-lg shadow-md p-8\">\r\n\r\n              {/* Title and Price */}\r\n              <div className=\"mb-6\">\r\n                {product.isFeatured && (\r\n                  <span className=\"inline-block bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full mb-3\">\r\n                    ⭐ Producto Destacado\r\n                  </span>\r\n                )}\r\n\r\n                <h1 className=\"text-3xl font-bold text-gray-900 mb-4\">\r\n                  {product.name}\r\n                </h1>\r\n\r\n                <div className=\"flex items-baseline space-x-3 mb-4\">\r\n                  <span className=\"text-4xl font-bold text-blue-600\">\r\n                    ${currentPrice.toFixed(2)}\r\n                  </span>\r\n                  {selectedVariant?.comparePrice && parseFloat(selectedVariant.comparePrice) > currentPrice && (\r\n                    <span className=\"text-2xl text-gray-400 line-through\">\r\n                      ${parseFloat(selectedVariant.comparePrice).toFixed(2)}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Stock Status */}\r\n                <div className=\"mb-6\">\r\n                  {isAvailable ? (\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <div className=\"flex items-center text-green-600 bg-green-50 px-3 py-1.5 rounded-lg\">\r\n                        <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                        </svg>\r\n                        <span className=\"font-semibold\">Disponible</span>\r\n                      </div>\r\n                      <span className=\"text-sm text-gray-600\">Listo para enviar</span>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center text-red-600 bg-red-50 px-3 py-1.5 rounded-lg inline-flex\">\r\n                      <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                        <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\r\n                      </svg>\r\n                      <span className=\"font-semibold\">Agotado</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Description */}\r\n              <div className=\"mb-6\">\r\n                <h2 className=\"text-lg font-semibold text-gray-900 mb-3\">Descripción</h2>\r\n                <p className=\"text-gray-600 leading-relaxed\">\r\n                  {product.description || 'Carcasa de alta calidad para proteger tu iPhone.'}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Compatibility */}\r\n              {product.compatibility && product.compatibility.length > 0 && (() => {\r\n                // Convertir a array si es string\r\n                const compatArray = Array.isArray(product.compatibility)\r\n                  ? product.compatibility\r\n                  : (typeof product.compatibility === 'string'\r\n                      ? JSON.parse(product.compatibility)\r\n                      : []);\r\n\r\n                return (\r\n                  <div className=\"mb-6\">\r\n                    <h3 className=\"text-sm font-semibold text-gray-900 mb-2\">Compatibilidad</h3>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {compatArray.map((model: string) => (\r\n                        <span\r\n                          key={model}\r\n                          className=\"bg-blue-50 text-blue-700 px-3 py-1 rounded-md text-sm font-medium\"\r\n                        >\r\n                          {model}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })()}\r\n\r\n              {/* Variant Selection */}\r\n              {product.variants.length > 0 && (\r\n                <div className=\"mb-6\">\r\n                  <h3 className=\"text-sm font-semibold text-gray-900 mb-3\">\r\n                    Selecciona una opción:\r\n                  </h3>\r\n                  <div className=\"grid grid-cols-2 gap-3\">\r\n                    {product.variants.filter(v => v.isActive).map(variant => (\r\n                      <button\r\n                        key={variant.id}\r\n                        onClick={() => setSelectedVariant(variant)}\r\n                        disabled={variant.stockQuantity === 0}\r\n                        className={`p-4 border-2 rounded-lg text-left transition-all ${\r\n                          selectedVariant?.id === variant.id\r\n                            ? 'border-blue-600 bg-blue-50 ring-2 ring-blue-200'\r\n                            : 'border-gray-200 hover:border-gray-300'\r\n                        } ${variant.stockQuantity === 0 ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                      >\r\n                        <div className=\"font-medium text-gray-900\">{variant.color}</div>\r\n                        <div className=\"text-sm text-gray-600\">${parseFloat(variant.price).toFixed(2)}</div>\r\n                        {variant.stockQuantity === 0 && (\r\n                          <div className=\"text-xs text-red-600 mt-1\">Agotado</div>\r\n                        )}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Quantity Selector */}\r\n              <div className=\"mb-6\">\r\n                <h3 className=\"text-sm font-semibold text-gray-900 mb-3\">Cantidad:</h3>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <button\r\n                    onClick={() => setQuantity(Math.max(1, quantity - 1))}\r\n                    className=\"w-10 h-10 border border-gray-300 rounded-md hover:bg-gray-50 font-semibold\"\r\n                  >\r\n                    -\r\n                  </button>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={quantity}\r\n                    onChange={(e) => setQuantity(Math.max(1, Math.min(currentStock, parseInt(e.target.value) || 1)))}\r\n                    className=\"w-20 text-center border border-gray-300 rounded-md py-2 font-semibold\"\r\n                    min=\"1\"\r\n                    max={currentStock}\r\n                  />\r\n                  <button\r\n                    onClick={() => setQuantity(Math.min(currentStock, quantity + 1))}\r\n                    className=\"w-10 h-10 border border-gray-300 rounded-md hover:bg-gray-50 font-semibold\"\r\n                  >\r\n                    +\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Add to Cart Button */}\r\n              <button\r\n                onClick={handleAddToCart}\r\n                disabled={!isAvailable}\r\n                className=\"w-full bg-blue-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed mb-4\"\r\n              >\r\n                {isAvailable ? 'Agregar al Carrito' : 'Producto Agotado'}\r\n              </button>\r\n\r\n              {/* Wishlist and Compare Buttons */}\r\n              <div className=\"grid grid-cols-2 gap-3 mb-6\">\r\n                <WishlistButton productId={product.id} variant=\"button\" />\r\n                <CompareButton product={product} variant=\"button\" />\r\n              </div>\r\n\r\n              {/* Additional Info */}\r\n              <div className=\"border-t pt-6 space-y-3\">\r\n                <div className=\"flex items-start text-sm text-gray-600\">\r\n                  <svg className=\"w-5 h-5 mr-3 text-blue-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\" />\r\n                  </svg>\r\n                  <div>\r\n                    <span className=\"font-medium text-gray-900\">Envío internacional</span>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">Tiempo estimado: 15-30 días hábiles</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-start text-sm text-gray-600\">\r\n                  <svg className=\"w-5 h-5 mr-3 text-green-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\r\n                  </svg>\r\n                  <div>\r\n                    <span className=\"font-medium text-gray-900\">Garantía de satisfacción</span>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">30 días de garantía en todos los productos</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-start text-sm text-gray-600\">\r\n                  <svg className=\"w-5 h-5 mr-3 text-purple-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                  </svg>\r\n                  <div>\r\n                    <span className=\"font-medium text-gray-900\">Pago seguro</span>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">Métodos de pago seguros y verificados</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Reviews Section */}\r\n        <div className=\"mt-12 bg-white rounded-lg shadow-md p-8\">\r\n          <ProductReviews productId={product.id} />\r\n        </div>\r\n\r\n        {/* Upsell/Cross-sell */}\r\n        <div className=\"mt-12\">\r\n          <UpsellCrossSell />\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductDetailPage;\r\n","// frontend/src/services/wishlistService.ts\r\nimport axios from 'axios';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';\r\n\r\nexport interface WishlistItem {\r\n  id: string;\r\n  productId: string;\r\n  name: string;\r\n  slug: string;\r\n  basePrice: number;\r\n  lowestPrice: number;\r\n  image: string | null;\r\n  inStock: boolean;\r\n  isFeatured: boolean;\r\n  addedAt: string;\r\n}\r\n\r\nclass WishlistService {\r\n  // Get auth token\r\n  private getAuthToken(): string | null {\r\n    return localStorage.getItem('token');\r\n  }\r\n\r\n  // Get user's wishlist\r\n  async getWishlist(): Promise<WishlistItem[]> {\r\n    const token = this.getAuthToken();\r\n    if (!token) {\r\n      throw new Error('No autenticado');\r\n    }\r\n\r\n    const response = await axios.get(`${API_URL}/wishlist`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`\r\n      }\r\n    });\r\n\r\n    return response.data.wishlist;\r\n  }\r\n\r\n  // Add product to wishlist\r\n  async addToWishlist(productId: string): Promise<void> {\r\n    const token = this.getAuthToken();\r\n    if (!token) {\r\n      throw new Error('Debes iniciar sesión para añadir a favoritos');\r\n    }\r\n\r\n    await axios.post(\r\n      `${API_URL}/wishlist/add`,\r\n      { productId },\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  // Remove product from wishlist\r\n  async removeFromWishlist(productId: string): Promise<void> {\r\n    const token = this.getAuthToken();\r\n    if (!token) {\r\n      throw new Error('No autenticado');\r\n    }\r\n\r\n    await axios.delete(`${API_URL}/wishlist/${productId}`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`\r\n      }\r\n    });\r\n  }\r\n\r\n  // Check if product is in wishlist\r\n  async checkInWishlist(productId: string): Promise<boolean> {\r\n    const token = this.getAuthToken();\r\n    if (!token) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.get(`${API_URL}/wishlist/check/${productId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      return response.data.inWishlist;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Get wishlist count\r\n  async getWishlistCount(): Promise<number> {\r\n    const token = this.getAuthToken();\r\n    if (!token) {\r\n      return 0;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.get(`${API_URL}/wishlist/count`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      return response.data.count;\r\n    } catch (error) {\r\n      return 0;\r\n    }\r\n  }\r\n}\r\n\r\nexport default new WishlistService();\r\n","import React, { useState, useEffect } from 'react';\r\nimport wishlistService from '../../services/wishlistService';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface WishlistButtonProps {\r\n  productId: string;\r\n  variant?: 'icon' | 'button';\r\n  size?: 'sm' | 'md' | 'lg';\r\n  className?: string;\r\n}\r\n\r\nconst WishlistButton: React.FC<WishlistButtonProps> = ({\r\n  productId,\r\n  variant = 'icon',\r\n  size = 'md',\r\n  className = ''\r\n}) => {\r\n  const [inWishlist, setInWishlist] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [checking, setChecking] = useState(true);\r\n\r\n  // Check if product is in wishlist on mount\r\n  useEffect(() => {\r\n    const checkWishlist = async () => {\r\n      try {\r\n        const isInWishlist = await wishlistService.checkInWishlist(productId);\r\n        setInWishlist(isInWishlist);\r\n      } catch (error) {\r\n        // User not logged in, that's fine\r\n      } finally {\r\n        setChecking(false);\r\n      }\r\n    };\r\n\r\n    checkWishlist();\r\n  }, [productId]);\r\n\r\n  const handleToggleWishlist = async (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (inWishlist) {\r\n        await wishlistService.removeFromWishlist(productId);\r\n        setInWishlist(false);\r\n        toast.success('Eliminado de favoritos');\r\n      } else {\r\n        await wishlistService.addToWishlist(productId);\r\n        setInWishlist(true);\r\n        toast.success('Añadido a favoritos');\r\n      }\r\n    } catch (error: any) {\r\n      if (error.message.includes('autenticado') || error.message.includes('sesión')) {\r\n        toast.error('Debes iniciar sesión para añadir a favoritos');\r\n      } else {\r\n        toast.error(inWishlist ? 'Error al eliminar de favoritos' : 'Error al añadir a favoritos');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const sizeClasses = {\r\n    sm: 'w-8 h-8',\r\n    md: 'w-10 h-10',\r\n    lg: 'w-12 h-12'\r\n  };\r\n\r\n  const iconSizes = {\r\n    sm: 'w-4 h-4',\r\n    md: 'w-5 h-5',\r\n    lg: 'w-6 h-6'\r\n  };\r\n\r\n  if (checking) {\r\n    return null; // or a loading skeleton\r\n  }\r\n\r\n  if (variant === 'icon') {\r\n    return (\r\n      <button\r\n        onClick={handleToggleWishlist}\r\n        disabled={loading}\r\n        className={`${sizeClasses[size]} flex items-center justify-center rounded-full transition-all duration-300 ${\r\n          inWishlist\r\n            ? 'bg-red-500 text-white hover:bg-red-600'\r\n            : 'bg-white text-gray-600 hover:bg-red-50 hover:text-red-500'\r\n        } ${loading ? 'opacity-50 cursor-not-allowed' : 'hover:scale-110'} shadow-md ${className}`}\r\n        aria-label={inWishlist ? 'Eliminar de favoritos' : 'Añadir a favoritos'}\r\n      >\r\n        {loading ? (\r\n          <svg className={`${iconSizes[size]} animate-spin`} fill=\"none\" viewBox=\"0 0 24 24\">\r\n            <circle\r\n              className=\"opacity-25\"\r\n              cx=\"12\"\r\n              cy=\"12\"\r\n              r=\"10\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"4\"\r\n            />\r\n            <path\r\n              className=\"opacity-75\"\r\n              fill=\"currentColor\"\r\n              d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\r\n            />\r\n          </svg>\r\n        ) : (\r\n          <svg\r\n            className={iconSizes[size]}\r\n            fill={inWishlist ? 'currentColor' : 'none'}\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\r\n            />\r\n          </svg>\r\n        )}\r\n      </button>\r\n    );\r\n  }\r\n\r\n  // Button variant\r\n  return (\r\n    <button\r\n      onClick={handleToggleWishlist}\r\n      disabled={loading}\r\n      className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-300 ${\r\n        inWishlist\r\n          ? 'bg-red-500 text-white hover:bg-red-600'\r\n          : 'bg-gray-100 text-gray-700 hover:bg-red-50 hover:text-red-500'\r\n      } ${loading ? 'opacity-50 cursor-not-allowed' : ''} ${className}`}\r\n    >\r\n      <svg\r\n        className=\"w-5 h-5\"\r\n        fill={inWishlist ? 'currentColor' : 'none'}\r\n        stroke=\"currentColor\"\r\n        viewBox=\"0 0 24 24\"\r\n      >\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          strokeWidth={2}\r\n          d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\r\n        />\r\n      </svg>\r\n      <span>{inWishlist ? 'En favoritos' : 'Añadir a favoritos'}</span>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default WishlistButton;\r\n"],"names":["_ref","product","variant","size","className","addToCompare","removeFromCompare","isInCompare","compareProducts","useCompare","inCompare","id","handleToggleCompare","e","preventDefault","stopPropagation","toast","success","length","error","sizeClasses","sm","md","lg","iconSizes","_jsx","onClick","concat","children","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_jsxs","productId","user","useAuth","reviews","setReviews","useState","stats","setStats","loading","setLoading","showForm","setShowForm","rating","setRating","title","setTitle","comment","setComment","customerName","setCustomerName","submitting","setSubmitting","API_URL","process","useEffect","loadReviews","async","response","fetch","data","json","console","renderStars","arguments","undefined","map","star","totalReviews","averageRating","toFixed","Math","round","count","distribution","percentage","style","width","onSubmit","trim","method","headers","body","JSON","stringify","userId","message","type","value","onChange","target","placeholder","required","maxLength","rows","disabled","review","isVerified","Date","createdAt","toLocaleDateString","year","month","day","UpsellCrossSell","addItem","useCart","selectedBundle","setSelectedBundle","products","discount","price","originalPrice","savings","badge","bundle","idx","fillRule","clipRule","icon","setTimeout","handleAddBundle","name","image","inStock","src","alt","Array","_","i","item","variantId","quantity","model","color","handleAddToCart","ProductDetailPage","_product$images$selec","_product$images$selec2","slug","useParams","navigate","useNavigate","setProduct","selectedImageIndex","setSelectedImageIndex","selectedVariant","setSelectedVariant","setQuantity","loadProduct","useCallback","productService","getProductBySlug","availableVariants","getAvailableVariants","getLowestPrice","trackingPixels","trackViewContent","content_name","content_ids","content_type","currency","handleVisibilityChange","document","visibilityState","addEventListener","removeEventListener","currentPrice","parseFloat","currentStock","stockQuantity","stockCount","isAvailable","Link","to","images","url","altText","onError","index","isFeatured","comparePrice","description","compatibility","compatArray","isArray","parse","variants","filter","v","isActive","max","min","parseInt","mainImage","getMainImage","replace","sku","maxQuantity","trackAddToCart","WishlistButton","CompareButton","ProductReviews","getAuthToken","localStorage","getItem","getWishlist","token","this","Error","axios","get","Authorization","wishlist","addToWishlist","post","removeFromWishlist","delete","checkInWishlist","inWishlist","getWishlistCount","setInWishlist","checking","setChecking","isInWishlist","wishlistService","checkWishlist","handleToggleWishlist","includes","cx","cy","r"],"sourceRoot":""}